<div class="threats-action" ng-controller="threatsAction">
    <div>
        <ul class="breadcrumb">
            <li>
                <a href="#" translate="Alerts"></a>
            </li>
            <li>
                <a href="#" translate="Suspect Action"></a>
            </li>
        </ul>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="padding-left15">
                <div class="page-header">
                    <h3>ID: <span ng-bind="alarm.alarmID"></span></h3>
                </div>
                <div class="padding-left15 computer-info">
                    <div class="text-danger" style="display: table-cell"><span
                            class="iconfont icon-computer"></span></div>
                    <div class="padding-left15" style="display: table-cell;">
                        <div>
                            <label class="media-heading"><span translate="Computer"></span>: </label>&nbsp;
                            <a class="text-info" data-toggle="modal" data-target="#comModal" ng-bind="alarm.computer.name"></a>
                        </div>
                        <div>
                            <label class="media-heading"><span translate="IP Address"></span>: </label>&nbsp;
                            <span ng-bind="alarm.computer.ip"></span>
                        </div>
                        <div>
                            <label class="media-heading"><span translate="Domain"></span>: </label>&nbsp;
                            <span ng-bind="alarm.computer.domain"></span>
                        </div>
                        <div>
                            <label class="media-heading"><span translate="Detect Time"></span>: </label>&nbsp;
                            <span ng-bind="alarm.time"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <hr>

    <div class="panel panel-default story-line-panel">
        <div class="panel-heading">
            <h3 class="panel-title">
                <span class="text-info">
                    <span class="glyphicon glyphicon-camera"></span> <span translate="Story Line"></span>
                </span>
            </h3>
        </div>
        <div class="panel-body">
            <div class="col-md-12" ng-class="{'col-md-9': showChartThreatDetail}">
                <div id="storyLineChart"></div>
            </div>
            <div ng-show="showChartThreatDetail" class="col-md-3 side-detail-box">
                <ul class="list-group side-detail">
                    <li class="list-group-item">
                        <i class="glyphicon glyphicon-remove pull-right padding-top10"
                           ng-click="closeSideDetail('chart')"></i>
                        <h4>
                            <span class="glyphicon glyphicon-cog"></span>
                            <span ng-bind="selectedChartNode_title"></span>
                        </h4>
                    </li>
                    <li class="list-group-item">
                        <p><span class="glyphicon glyphicon-time"></span> {{selectedChartNode.time}}</p>
                        <p><label translate="Source Object"></label>
                        <p ng-repeat="k in selectedChartNode_srcObj_keys"><label >{{k}}</label>: <span ng-bind="selectedChartNode_srcObj[k]"></span></p>
                    </li>
                    <hr style="margin-top: 0; border: 2px solid white">
                    <li class="list-group-item">
                        <p><label translate="Target Object"></label>
                        <p ng-repeat="k in selectedChartNode_tarObj_keys"><label >{{k}}</label>: <span ng-bind="selectedChartNode_tarObj[k]"></span></p>
                    </li>
                </ul>
            </div>
        </div>
    </div>


    <div class="panel panel-default story-line-panel">
        <div class="panel-heading">
            <a class="btn btn-default btn-sm pull-right" style="margin-top: -6px">
                <span class="glyphicon glyphicon-th-large glyphicon glyphicon-download-alt"></span>
            </a>
            <h3 class="panel-title">
                <span class="text-info">
                    <span class="glyphicon glyphicon-time"></span> <span translate="Time Sequence Table"></span>
                </span>
            </h3>
        </div>
        <div class="panel-body">
            <div class="col-md-12" ng-class="{'col-md-9': showTableThreatDetail}">
                <table class="table table-striped table-hover bootstrap-datatable responsive">
                    <thead>
                    <tr>
                        <th translate="Time"></th>
                        <th translate="Event"></th>
                        <th translate="Computer"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="item in alarm.events" ng-click="showSideDetail(item, 'Table')">
                        <td translate="{{item.time}}"></td>
                        <td translate="{{item.action}}"></td>
                        <td translate="{{alarm.computer.name}}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div ng-show="showTableThreatDetail" class="col-md-3 side-detail-box">
                <ul class="list-group side-detail">
                    <li class="list-group-item">
                        <i class="glyphicon glyphicon-remove pull-right padding-top10"
                           ng-click="closeSideDetail('Table')"></i>
                        <h4>
                            <span class="glyphicon glyphicon-cog"></span>
                            <span ng-bind="selectedTableNode_title"></span>
                        </h4>
                    </li>
                    <li class="list-group-item">
                        <p><span class="glyphicon glyphicon-time"></span> {{selectedTableNode.time}}</p>
                        <p><label translate="Source Object"></label>
                        <p ng-repeat="k in selectedTableNode_srcObj_keys"><label >{{k}}</label>: <span ng-bind="selectedTableNode_srcObj[k]"></span></p>
                    </li>
                    <hr style="margin-top: 0; border: 2px solid white">
                    <li class="list-group-item">
                        <p><label translate="Target Object"></label>
                        <p ng-repeat="k in selectedTableNode_tarObj_keys"><label >{{k}}</label>: <span ng-bind="selectedTableNode_tarObj[k]"></span></p>

                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="comModal" id="comModal" datasource="computer"></div>
</div>